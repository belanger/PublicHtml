<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.34">
<style type="text/css">
.li-itemize{margin:1ex 0ex;}
.li-enumerate{margin:1ex 0ex;}
.dd-description{margin:0ex 0ex 1ex 4ex;}
.dt-description{margin:0ex;}
.toc{list-style:none;}
.footnotetext{margin:0ex; padding:0ex;}
div.footnotetext P{margin:0px; text-indent:1em;}
.thefootnotes{text-align:left;margin:0ex;}
.dt-thefootnotes{margin:0em;}
.dd-thefootnotes{margin:0em 0em 0em 2em;}
.footnoterule{margin:1em auto 1em 0px;width:50%;}
.caption{padding-left:2ex; padding-right:2ex; margin-left:auto; margin-right:auto}
.title{margin:2ex auto;text-align:center}
.titlemain{margin:1ex 2ex 2ex 1ex;}
.titlerest{margin:0ex 2ex;}
.center{text-align:center;margin-left:auto;margin-right:auto;}
.flushleft{text-align:left;margin-left:0ex;margin-right:auto;}
.flushright{text-align:right;margin-left:auto;margin-right:0ex;}
div table{margin-left:inherit;margin-right:inherit;margin-bottom:2px;margin-top:2px}
td table{margin:auto;}
table{border-collapse:collapse;}
td{padding:0;}
.cellpadding0 tr td{padding:0;}
.cellpadding1 tr td{padding:1px;}
pre{text-align:left;margin-left:0ex;margin-right:auto;}
blockquote{margin-left:4ex;margin-right:4ex;text-align:left;}
td p{margin:0px;}
.boxed{border:1px solid black}
.textboxed{border:1px solid black}
.vbar{border:none;width:2px;background-color:black;}
.hbar{border:none;height:2px;width:100%;background-color:black;}
.hfill{border:none;height:1px;width:200%;background-color:black;}
.vdisplay{border-collapse:separate;border-spacing:2px;width:auto; empty-cells:show; border:2px solid red;}
.vdcell{white-space:nowrap;padding:0px; border:2px solid green;}
.display{border-collapse:separate;border-spacing:2px;width:auto; border:none;}
.dcell{white-space:nowrap;padding:0px; border:none;}
.dcenter{margin:0ex auto;}
.vdcenter{border:solid #FF8000 2px; margin:0ex auto;}
.minipage{text-align:left; margin-left:0em; margin-right:auto;}
.marginpar{border:solid thin black; width:20%; text-align:left;}
.marginparleft{float:left; margin-left:0ex; margin-right:1ex;}
.marginparright{float:right; margin-left:1ex; margin-right:0ex;}
.theorem{text-align:left;margin:1ex auto 1ex 0ex;}
.part{margin:2ex auto;text-align:center}
.lstlisting{font-family:monospace;white-space:pre;margin-right:auto;margin-left:0pt;text-align:left}
</style>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<title>01-RatesOfChange</title>
</head>
<body >
<!--HEVEA command line is: hevea -I /home/belanger/JBerd/Config/TeX/Sty/ 01-RatesOfChange.tex -->
<!--CUT STYLE article--><!--CUT DEF section 1 --><p>

<div>
<div id="maindiv" style="max-height: 500px; overflow:auto">



\(
\newcommand{\vect}[1]
{\mathbf{#1}}
\newcommand{\vectr}[1]
{\begin{pmatrix} #1 \end{pmatrix}}
\)

</p><div class="center">
<span style="font-weight:bold"><span style="font-size:x-large">Section 1<br>
 Average Rates of Change
</span></span></div><p>Differential calculus is the study of rates of change.
&#X201C;Velocity&#X201D; means the same thing as &#X201C;rate of change&#X201D;, although we
usually use velocity to mean the rate of change of distance with
respect to time. The average velocity of an object is the distance it
travels divided by how long it takes to travel that distance. If a
person walks \(200\) yards in \(25\) seconds, their average velocity will
be \(200\text{ yards}/25\text{ seconds} = 8\text{ yards/second}\).</p><p>Note that speed is not quite the same as velocity. &#X201C;Speed&#X201D; indicates
how fast an object is traveling; &#X201C;velocity&#X201D; indicates how fast
and in which direction. If an object is moving on a line, we will indicate
one direction on the line as positive and one direction as negative.
If there is a horizontal line in front of us, we will normally
take the right to be the positive direction and left to be the
negative. If an object has speed 5 meters/second, it could
be moving to the left or the right. If an object has velocity 
5 meters/second, it will be moving to the right. An object with
velocity -5 meters/second will be moving to the left. In higher dimensions,
describing velocities involves more than a single number; in this
class, we will only deal with motion along a line.</p><p>To find the average velocity of an object we typically have to
find out how far the object travels (its change in position) and and
the length of time it takes (the change in time). So let&#X2019;s begin by
discussing change.</p><p>We&#X2019;ll start with some notation. The symbol \(\Delta\) (the Greek letter
Delta, corresponding to the Latin letter &#X201C;D&#X201D;, as in
<span style="font-weight:bold">D</span>ifference) is used to indicate how much a quantity changes,
and so &#X201C;\(\Delta x\)&#X201D; represents the amount the variable \(x\) changes
and can be read &#X201C;the change in \(x\)&#X201D;.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Definition </span></span><br>
 If a quantity \(x\) changes from the value \(a\) to the value \(b\), then
\[\Delta x = b - a.\]
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
 If the quantity \(x\) increases from \(3\) to \(7\), then 
\[\Delta x = 7-3 = 4.\]
<br>
</p><p>Of course, there is nothing special about the letter \(x\).</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
 If the quantity \(t\) changes from \(2\) to \(9\), then
\[\Delta t = 9 - 2 = 7.\]
<br>
</p><p>There is no reason why \(b\) has to be larger than \(a\) in the above
definition; the quantity does not have to increase.</p><p>If the value of \(y=f(x)\) depends on \(x\), then a change in the value of
\(x\) will cause the value of \(y\) to change also, so the change in these
two quantities will be related.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
 Let \(y=x^2\). If \(x\) changes from \(x=1\) to \(x=3\), then \(y\) will
change from \(y=1^2=1\) to \(y=3^2=9\). We will have
\begin{align*}
    \Delta x &= 3 - 1 = 2\\
    \Delta y &= 9 - 1 = 8.
  \end{align*}
<br>
</p><p>The average rate of change of one quantity with respect to another is
the ratio of the change in the first quantity changes to that of
the second.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Definition </span></span><br>
The <span style="font-style:italic"><span style="font-weight:bold">average rate of change</span></span> of \(y=f(x)\) (with respect to \(x\)) 
from \(x=a\) to \(x=b\) is
\[    
     \frac{\Delta y}{\Delta x} = \frac{f(b) - f(a)}{b-a}.
  \]
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
Let \(y=f(x) = 2x^2\). Find the average rate of change of \(y\) with
respect to \(x\) from \(x=2\) to \(x=5\). 
<br>
</p><p>We first of all have \(\Delta x = 5 - 2 = 3\). Next, as \(x\) changes
from \(x=2\) to \(x=5\), \(y=f(x)\) will change from 
\(y=f(2)= 2\cdot2^2 = 8\) to \(y=f(5)=2\cdot5^2=50\), so 
\(\Delta y = 50 - 8 = 42\). 
Putting it together, the average rate of change of \(y\) from
\(x=2\) to \(x=5\) is 
\[
  \frac{\Delta y}{\Delta x} = \frac{42}{3}=14
  \]
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
Let \(y=f(x) = 1/x\). Find the average rate of change of \(y\) with
respect to \(x\) from \(x=1\) to \(x=3\). 
<br>
</p><p>Since \(\Delta x = 3 - 1 = 2\) and 
\(\Delta y=f(3) - f(1)= 
  \frac{1}{3} - \frac{1}{1} = -\frac{2}{3}\),
the average rate of change of \(y\) from \(x=1\) to \(x=3\) is 
\[
  \frac{\Delta y}{\Delta x} = \frac{-\frac{2}{3}}{1} = -\frac{2}{3}.
  \]
<br>
</p><p>The rate of change of \(y\) with respect to \(x\) tells us how fast \(y\)
changes relative to \(x\). If \(\Delta y/\Delta x = 2\), for example,
then \(y\) is changes twice as much as \(x\) over the given interval, and
so on the average \(y\) is changing twice as fast over the interval. The 
larger the rate of change, the faster \(y\) is changing compared to \(x\). 
Note that in the second example above, the rate of change is negative; that
means that \(y\) is changing in the opposite direction as \(x\) &#X2014; the
quantity \(y\) is getting smaller as \(x\) gets larger.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
A ball is dropped from the top of a tall building, so that in \(t\)
seconds it will have fallen \(y=f(t) = 16t^2\) feet. What is the
average velocity of the ball from \(t=1\) to \(t=3\) seconds?
<br>
</p><p>Since
\[ \Delta t = 3 - 1 = 2 \text{ seconds}\]
and
\[ \Delta y = f(3)-f(1) = 144 - 16 = 128 \text{ feet},\]
the average velocity of the ball from time \(t=1\) second to \(t=3\)
seconds is 
\[
  \frac{\Delta y}{\Delta t} = \frac{128}{2} = 64 \text{ feet/sec}
  \]
<br>
</p><p>If we are given the velocity, then we can use that to find the
distance travelled.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
Suppose a bike travels for \(3\) hours at \(25\) miles/hour. How far
does it travel?
<br>
</p><p>The bike will travel a distance of \(3\) hours times \(25\) miles/hour
for a total of \(75\) miles.
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
Suppose \(y=f(x)\) and the average rate of change of \(y\) with
respect to \(x\) from \(x=1\) to \(x=5\) is \(\Delta y/\Delta x = 7\).
Find \(\Delta y\).
<br>
</p><p>Since \(\Delta x = 5 - 1 = 4\) and \(\Delta y/\Delta x =7\), we get
\(\Delta y = \left( \Delta y/\Delta x\right) \Delta x = 7\cdot 4 = 28\).
<br>
</p><p>If we know how far an object moves and its beginning position, we can
figure out its ending position.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
A car travels directly away from us for \(5\) hours, at an average
velocity of \(40\) miles/hour. If it starts out \(120\) miles away, how
far away is it after the \(5\) hours?
<br>
</p><p>The car travels away from us a distance of \(5\cdot 40 = 200\) miles.
Since it starts off \(120\) miles away, it ends up a distance of
\(120+200\) miles.
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
Suppose \(y=f(x)\). If \(f(2) = 12\) and, as \(x\) changes from \(x=2\)
to \(x=4\), the average rate of change of \(y\) with respect to \(x\) is
\(\Delta y/\Delta x = 5\). What is \(f(4)\)?
<br>
</p><p>As \(x\) changes from \(x=2\) to \(x=4\), the amount that \(y=f(x)\) changes
is \(\Delta y = \left(\Delta y/\Delta x\right)\Delta x = 5\cdot 2 =
  10\). Since at \(x=2\), \(y\) begins with the value \(f(2)=12\), \(y\) ends
up with the value \(f(4) = 12 + 10 = 22\).
<br>
</p><p>Geometrically, the average rate of change of a function can be
interpreted as the slope of a secant line. A <span style="font-style:italic"><span style="font-weight:bold">secant line</span></span> is a
line through two points of a specified curve. We will usually want to
specify the points.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Definition </span></span><br>
 The <span style="font-style:italic"><span style="font-weight:bold">secant line</span></span> to the graph \(y=f(x)\) from \(x=a\) and \(x=b\) is
the line through \((a,f(a))\) and \((b,f(b))\). (See figure 
<a href="#fig%3Arates-secantline">1</a>.)
<br>
</p><blockquote class="figure"><div class="center"><div class="center"><hr style="width:80%;height:2"></div>
<img src="01-RatesOfChange001.png">
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 1: A secant line.</td></tr>
</table></div>
<a id="fig:rates-secantline"></a>
<div class="center"><hr style="width:80%;height:2"></div></div></blockquote><p>The slope of the secant line is \((f(b)-f(a))/(b-a)=\Delta y/\Delta x\), 
which is exactly the average rate of change of \(f\) from \(x=a\) to \(x=b\).</p><p>Differential calculus, unfortunately, is not the study of
<em>average</em> velocities, but rather the study of
<em>instantaneous</em> velocities &#X2014; how fast something is changing at an
<em>instant</em> or point. But now we&#X2019;re faced with a problem: in an
instant, the dependent variable doesn&#X2019;t change. In the formula for
rate of change,
\[ 
  \frac{\Delta y}{\Delta x},
\]
the denominator \(\Delta x\) will be \(0\), and division by \(0\) is
forbidden. So we need a different, but not too different, definition
for velocity at a point. Any reasonable definition of velocity
<em>at</em> a point should give values close to the velocities <em>near</em>
the point. </p><p>Let&#X2019;s look at a concrete situation. In the example with the falling
ball, the ball will have fallen \(f(t)=16t^2\) feet in \(t\) seconds. How
fast is it going in exactly \(3\) seconds? Let&#X2019;s look at the rate of
change <em>near</em> \(t=3\) seconds. In other words, let&#X2019;s look at the
rate of change from \(3\) seconds to \(t\) seconds for some values of
\(t\) close to \(3\).
</p><ul class="itemize"><li class="li-itemize">
From \(t=3\) to \(t=3.1\) seconds, the ball&#X2019;s average velocity
will be 
\[
\frac{f(3.1) - f(3)}{3.1-3} = \frac{153.76 - 144}{.1} = 97.6 
\text{ feet/sec.}
\]</li><li class="li-itemize">From \(t=3\) seconds to \(t=3.01\) seconds, the average velocity is
\[
\frac{f(3.01) - f(3)}{3.01-3} = \frac{144.9616 - 144}{.1} = 
96.16 \text{ feet/sec}
\]</li><li class="li-itemize">From \(t=3\) seconds to \(t=3.001\) seconds, the average velocity is 
\[
\frac{f(3.001) - f(3)}{3.001-3} = \frac{144.096016 - 144}{.001} = 
96.016 \text{ feet/sec.}
\]
</li></ul><p>
The velocity of the ball <em>at</em> \(t=3\) seconds should be close to
these average velocities, and should probably be closer to the average
velocities over the smaller intervals. It looks as if these average
velocities are approaching \(96 \text{ feet/sec}\), and indeed they
are. We wouldn&#X2019;t be too far off if we said that the velocity
<em>at</em> a point is simply the average velocity over a small interval
<em>near</em> the point. In fact, that is a pretty good way to think of
an instantaneous rate of change.</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Definition (informal)</span></span><br>
 The <span style="font-style:italic"><span style="font-weight:bold">instantaneous rate of change</span></span> of \(y=f(x)\) (with respect to \(x\)) 
at \(x=a\) is the average rate of change of \(y=f(x)\) over a small
interval near \(x=a\).
<br>
</p><p><br>
</p><p><span style="font-weight:bold"><span style="font-variant:small-caps">Example </span></span><br>
 Going back to our previous example with the falling
ball, where the ball will have fallen \(f(t)=16t^2\) feet in \(t\)
seconds, we could (not quite accurately) say that the ball&#X2019;s
velocity in exactly \(3\) seconds is the average velocity over the
interval from \(t=3\) to \(t=3.001\) seconds; namely the \(96.016
  \text{feet/sec}\).</p><p>This isn&#X2019;t quite the exact answer; what&#X2019;s more, it depends on the
small interval we use. The average velocity over the interval from 
\(t=3\) to \(t=3.0005\) seconds, for example, is \(96.008
  \text{feet/sec}\), which is a different value than above. 
Nevertheless, this is a useful way to think about
the instantaneous rate of change.
<br>
</p><p>

</div>
<div id="controldiv" style="max-height: 400px; overflow:auto">
<span id="controlindex"></span>
<button title="Clone last command to Xcas for Firefox" onclick="UI.clone()">Clone</button>
<button title="Clear console" onclick="document.getElementById('output').innerHTML='';">Clear</button>
<button title="Increase console size" onclick="var field=document.getElementById('output'); var s=field.style.maxHeight; s=s.substr(0,s.length-2);s=eval(s)+20 ;if(s<innerHeight/2){s=s+'px';field.style.maxHeight=s; field=document.getElementById('maindiv'); s=field.style.maxHeight; s=s.substr(0,s.length-2);s=eval(s)-20; s=s+'px';field.style.maxHeight=s;}">+</button>
<button title="Decrease console size" onclick="var field=document.getElementById('output'); var s=field.style.maxHeight; s=s.substr(0,s.length-2);s=eval(s)-20 ; if(s>80){s=s+'px';field.style.maxHeight =s;field=document.getElementById('maindiv'); s=field.style.maxHeight; s=s.substr(0,s.length-2);s=eval(s)+20; s=s+'px';field.style.maxHeight=s;}">-</button>
<textarea title="Commandline for a quick computation" onkeypress="UI.ckenter(event,this,3);" style="width:400px;height:20px;font-size:large"></textarea><button  title="Eval previous cell" onclick="UI.quick(this);">-></button><span></span>
&nbsp;&nbsp;<button onclick="var s=UI.caseval('restart;'); Module.print(s);" title="Reset CAS computing kernel">Restart</button>
<button onclick="UI.exec(document.documentElement);" title='Click here to exec all commands (maybe be long!)'>Exec. all</button>
<canvas id='canvas' width=0 height=0   onmousedown="UI.canvas_pushed=true;UI.canvas_lastx=event.clientX; UI.canvas_lasty=event.clientY;"  onmouseup="UI.canvas_pushed=false;" onmousemove="UI.canvas_mousemove(event,'')"></canvas>
<div id="output" style="max-height: 80px; overflow:auto"></div>
</div>
</div>


<script language="javascript"> 
var Module = { 
        htmlcheck:true,
        htmlbuffer:'',
        preRun: [],
        postRun: [],
        ready:false,
        print: (function() {
          var element = document.getElementById('output');
          element.innerHTML='';// element.value = ''; // clear browser cache
          return function(text) {
            //console.log(text.charCodeAt(0));
            if (text.length==1 && text.charCodeAt(0)==12){ element.innerHTML=''; return; }
            if (text.length>=1 && text.charCodeAt(0)==2) {console.log('STX');Module.htmlcheck=false; htmlbuffer='';return;}
            if (text.length>=1 && text.charCodeAt(0)==3) {console.log('ETX');Module.htmlcheck=true; element.style.display='inherit'; element.innerHTML += htmlbuffer;htmlbuffer='';element.scrollTop = 99999; return;}
            if (Module.htmlcheck){
            // These replacements are necessary if you render to raw HTML 
             text = text.replace(/&/g, "&amp;");
             text = text.replace(/</g, "&lt;");
             text = text.replace(/>/g, "&gt;");
             text = text.replace('\n', '<br>', 'g');
             text += '<br>'
             element.style.display='inherit';
             element.innerHTML += text; // element.value += text + "\n";
             element.scrollTop = 99999; // focus on bottom
            } else htmlbuffer += text;
          };
        })(),
     canvas: document.getElementById('canvas'),};
Module['onRuntimeInitialized']=function(){ console.log('UI is ready'); Module.ready=true;}
</script>



<script async>
  var UI={
   detectmob:function() { 
    if( navigator.userAgent.match(/Android/i)
	|| navigator.userAgent.match(/webOS/i)
	|| navigator.userAgent.match(/iPhone/i)
	|| navigator.userAgent.match(/iPad/i)
	|| navigator.userAgent.match(/iPod/i)
	|| navigator.userAgent.match(/BlackBerry/i)
	|| navigator.userAgent.match(/Windows Phone/i)
      ) return true;
    else 
      return false;
   },
   readCookie:function(name) {
    if (window.localStorage){
      var tmp=localStorage.getItem(name);
      if (tmp!=null) return tmp;
    }
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
      var c = ca[i];
      while (c.charAt(0)==' ') c = c.substring(1,c.length);
      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
   },
  }
  var script = document.createElement("script");
  script.type = "text/javascript";
  var webAssemblyAvailable = true; // false;
  if (Boolean(window.chrome)){
    if (!UI.detectmob()) webAssemblyAvailable =  window.location.href.substr(0,4)!='file';
  }
  else {
    var ua = window.navigator.userAgent;
    var old_ie = ua.indexOf('MSIE ');
    var new_ie = ua.indexOf('Trident/');
    if (!UI.detectmob() && old_ie<=-1 && new_ie<=-1)
      webAssemblyAvailable =!!window.WebAssembly;
  }
  if (webAssemblyAvailable){
    var ck=UI.readCookie('xcas_wasm');
    if (ck)
      webAssemblyAvailable=(ck=='1');
  }
  if (webAssemblyAvailable) // fixme: enable
    script.src =""+"giacwasm.js";
  else
    script.src  =""+"giac.js";
  document.getElementsByTagName("head")[0].appendChild(script);
</script>




<script language="javascript"> 
 var UI = {
  Datestart:Date.now(),
  n2d:0,
  python:0,
  histcount:0,
  usemathjax:false,
  lastcmd:'',
  clone:function(){
    if (UI.lastcmd.length){
       var tmp=UI.giaceval('VARS(-1)');
       tmp=encodeURIComponent(tmp);
       var url='https://www-fourier.univ-grenoble-alpes.fr/~parisse/xcasen.html'+String.fromCharCode(35)+'+'+tmp+':;&+'+UI.lastcmd;
       console.log(url);
       window.open(url,'_blank');
    }
  },
  canvas_pushed:false,
  canvas_lastx:0,
  canvas_lasty:0,
  canvas_mousemove:function(event,no){
    if (UI.canvas_pushed){
      // Module.print(event.clientX);
      if (UI.canvas_lastx!=event.clientX){
        if (event.clientX>UI.canvas_lastx)
          giac3d('r'+no);
        else
          giac3d('l'+no);
        UI.canvas_lastx=event.clientX;
      }
      if (UI.canvas_lasty!=event.clientY){
        if (event.clientY>UI.canvas_lasty)
          giac3d('d'+no);
        else
          giac3d('u'+no);
        UI.canvas_lasty=event.clientY;
      }
    }
  },  
  count_newline:function(s){
    var ss=s.length,i,res=1;
    for (i=0;i<ss;i++){
      if (s[i]=='\n') res++;
    }
    return res;
  },
  ltgt:function(s){
    var ss=s.length,i,res='',c=0;
    for (i=0;i<ss-4;i++){
      if (s[i]=='\n') c++;      
      if (s[i]!='&' || s[i+2]!='t' || s[i+3]!=';'){
        res += s[i];
        continue;
      }
      if (s[i+1]=='l'){
        res += '<';
        i +=3;
        continue;
      }
      if (s[i+1]=='g'){
        res += '>';
        i +=3;
        continue;
      }
      res += s[i];
    }
    for (;i<ss;i++) res+=s[i];
    return [res,c];
  },
  rmquote:function(tmp){
    var s=tmp.length;
    if (s>2 && tmp.charCodeAt(0)==34 && tmp.charCodeAt(s-1)==34)
      tmp=tmp.substr(1,s-2);
    return tmp;
  },
  renderhelp: function (s) {
    var pos0 = s.search("</b>");
    //console.log(s);
    var found = (s.substr(pos0 + 7, 20) != "Best match has score");
    var lh = s.substr(3, pos0 - 3);
    var unlocalized_cmd = lh;
    var sorig = s;
    pos1 = s.search("<br>");
    if (pos1 < 0) return sorig;
    var explication = s.substr(0, pos1);
    s = s.substr(pos1 + 4, s.length - pos1 - 4);
    pos1 = s.search("<br>");
    if (pos1 < 0) return sorig;
    var syntaxe = s.substr(0, pos1);
    s = s.substr(pos1 + 4, s.length - pos1 - 4);
    pos1 = s.search("<br>");
    if (pos1 < 0) return sorig;
    var voiraussi = s.substr(0, pos1);
    var examples = s.substr(pos1 + 4, s.length - pos1 - 4);
    s = '';//'<b>'+unlocalized_cmd+':</b> ';
    if (found)
      s += explication + '<br>See also: ' +voiraussi+'<br><b>Examples : </b>'+examples;
    else
      s += explication.substr(0, pos0);
    return s;
  },   
  quick:function(field){
    var tmp1=field.previousSibling.value;
    var tmp=UI.caseval(tmp1);
    tmp=UI.rmquote(tmp); 
    tmp=UI.latexeval(tmp);
    Module.print(String.fromCharCode(2));
    Module.print("<tt>");
    Module.print(tmp1);
    Module.print("</tt><br>&nbsp;&nbsp;");
    if (tmp.length>3 && tmp.substr(0,3)=='<b>'){ 
       Module.print(UI.renderhelp(tmp)); tmp='';
    } else Module.print(tmp);
    Module.print("<br>");
    Module.print(String.fromCharCode(3));
    field.nextSibling.innerHTML='&nbsp;'+tmp;
   //UI.render_canvas(nextSibling);  
  },
  giaceval:function(text){
     if (UI.python) text='@@'+text;
     if (!Module.ready){ window.setTimeout(UI.giaceval,100,text); return " ... ";}
     var dogiaceval=Module.cwrap('caseval',  'string', ['string']);
     return dogiaceval(text);
  },
  caseval:function(text){
    UI.lastcmd=text;
    var s="not evaled",err;
    try {
       s= UI.giaceval(text);
    } catch (err) { s=err.message;}
    var is_2d=s.length>4 && s.substr(0,4)=='gr2d';
    if (is_2d){
      s = '<canvas id="gr2d_'+UI.n2d+'" width=400 height=250>'+s+'</canvas>';
      //console.log(UI.n2d,s);
      UI.n2d++;
    }
    var is_3d=s.length>5 && s.substr(0,5)=='gl3d ';
    if (is_3d){
	var n3d=s.substr(5,s.length-5);
	s = '<canvas id="gl3d_'+n3d+'" onmousedown="UI.canvas_pushed=true;UI.canvas_lastx=event.clientX; UI.canvas_lasty=event.clientY;" onmouseup="UI.canvas_pushed=false;" onmousemove="UI.canvas_mousemove(event,'+n3d+')" width=400 height=250></canvas>';
    }
   //console.log(s);
    return s;
  },
  pourcentmod:function(a,b){
    return a-Math.floor(a/b)*b;
  },
  color_list: ['black',
    'red',
    'green',
    'yellow',
    'blue',
    'magenta',
    'cyan',
    'white',
    'silver',
    'gray',
    'maroon',
    'purple',
    'fuchsia',
    'lime',
    'olive',
    'navy',
    'teal',
    'aqua',
    'antiquewhite',
    'aquamarine',
    'azure',
    'beige',
    'bisque',
    'blanchedalmond',
    'blueviolet',
    'brown',
    'burlywood',
    'cadetblue',
    'chartreuse',
    'chocolate',
    'coral',
    'cornflowerblue',
    'cornsilk',
    'crimson',
    'cyan',
    'darkblue',
    'darkcyan',
    'darkgoldenrod',
    'darkgray',
    'darkgreen',
    'darkgrey',
    'darkkhaki',
    'darkmagenta',
    'darkolivegreen',
    'darkorange',
    'darkorchid',
    'darkred',
    'darksalmon',
    'darkseagreen',
    'darkslateblue',
    'darkslategray',
    'darkslategrey',
    'darkturquoise',
    'darkviolet',
    'deeppink',
    'deepskyblue',
    'dimgray',
    'dimgrey',
    'dodgerblue',
    'firebrick',
    'floralwhite',
    'forestgreen',
    'gainsboro',
    'ghostwhite',
    'gold',
    'goldenrod',
    'greenyellow',
    'grey',
    'honeydew',
    'hotpink',
    'indianred',
    'indigo',
    'ivory',
    'khaki',
    'lavender',
    'lavenderblush',
    'lawngreen',
    'lemonchiffon',
    'lightblue',
    'lightcoral',
    'lightcyan',
    'lightgoldenrodyellow',
    'lightgray',
    'lightgreen',
    'lightgrey',
    'lightpink',
    'lightsalmon',
    'lightseagreen',
    'lightskyblue',
    'lightslategray',
    'lightslategrey',
    'lightsteelblue',
    'lightyellow',
    'limegreen',
    'linen',
    'mediumaquamarine',
    'mediumblue',
    'mediumorchid',
    'mediumpurple',
    'mediumseagreen',
    'mediumslateblue',
    'mediumspringgreen',
    'mediumturquoise',
    'mediumvioletred',
    'midnightblue',
    'mintcream',
    'mistyrose',
    'moccasin',
    'navajowhite',
    'oldlace',
    'olivedrab',
    'orangered',
    'orchid',
    'palegoldenrod',
    'palegreen',
    'paleturquoise',
    'palevioletred',
    'papayawhip',
    'peachpuff',
    'peru',
    'pink',
    'plum',
    'powderblue',
    'rosybrown',
    'royalblue',
    'saddlebrown',
    'salmon',
    'sandybrown',
    'seagreen',
    'seashell',
    'sienna',
    'skyblue',
    'slateblue',
    'slategray',
    'slategrey',
    'snow',
    'springgreen',
    'steelblue',
    'tan',
    'thistle',
    'tomato',
    'turquoise',
    'violet',
    'wheat',
    'whitesmoke',
    'yellowgreen'],
  arc_en_ciel: function (k) {
    var r, g, b;
    k += 21;
    k = pourcentmod(k,126);
    if (k < 0)
      k += 126;
    if (k < 21) {
      r = 251;
      g = 0;
      b = 12 * k;
    }
    if (k >= 21 && k < 42) {
      r = 251 - (12 * (k - 21));
      g = 0;
      b = 251;
    }
    if (k >= 42 && k < 63) {
      r = 0;
      g = (k - 42) * 12;
      b = 251;
    }
    if (k >= 63 && k < 84) {
      r = 0;
      g = 251;
      b = 251 - (k - 63) * 12;
    }
    if (k >= 84 && k < 105) {
      r = (k - 84) * 12;
      g = 251;
      b = 0;
    }
    if (k >= 105 && k < 126) {
      r = 251;
      g = 251 - (k - 105) * 12;
      b = 0;
    }
    return 'rgb(' + r + ',' + g + ',' + b + ')';
  },
  turtle_color: function (c) {
    if (c >= 0x100) {
      if (c < 0x17e)
        return UI.arc_en_ciel(c);
      var r=8*((c>>11) & 0x1f);
      var g=4*((c>>5) & 0x3f);
      var b=8*(c & 0x1f);
      return 'rgb(' + r + ',' + g + ',' + b + ')';
    }
    return UI.color_list[c];
  },
  pixon_draw: function (id, s) {
    var v = eval(s);
    if (!Array.isArray(v)) return;
    //console.log(v[0], v.length);
    var canvas = document.getElementById(id);
    var l = v.length, w = 0, h = 0;
    if (l < 2) return;
    var scale = v[0];
    for (var k = 1; k < l; k++) {
      var cur = v[k];
      var x = cur[0], y = cur[1];
      if (cur.length==3 && typeof cur[2]!="number"){
	x+=100;
	y+=16;
      }
      if (cur.length==4) {
        var tmp = cur[3];
	if (typeof tmp=="number"){
          if (tmp > 0) y += tmp; else x -= tmp;
	} else {
	  x+=100;
	  y+=16;
	}
      }
      //console.log(cur,x,y);
      if (x > w) w = x;
      if (y > h) h = y;
    }
    w = (w + 1) * scale;
    h = (h + 1) * scale;
    canvas.width = w;
    canvas.height = h;
    //console.log(h,w);
    if (canvas.getContext) {
      var ctx = canvas.getContext('2d');
      for (var k = 1; k < l; k++) {
        var cur = v[k], cl;
        //console.log(cur);
        if (!Array.isArray(cur) || (cl = cur.length) < 2) continue;
        // cur[0]=x, cur[1]=y, cur[2]=color, cur[3]=w if +, h if -
        var x = cur[0] * scale;
        var y = cur[1] * scale;
	if (cl>2 && typeof cur[2]=="string"){
	  console.log(cur[2]);
	  ctx.font = '16px serif';
	  ctx.fillStyle = 'black';
	  ctx.fillText(cur[2],x,y+16,100);
	  continue;
	}
        ctx.fillStyle = (cl > 2) ? UI.turtle_color(cur[2]) : 'black';
        if (cl < 4) {
          ctx.fillRect(x, y, scale, scale);
          continue;
        }
	if (typeof cur[3]=="string"){
	  ctx.font = '16px serif';
	  ctx.fillText(cur[3],x,y+16,100);
	  continue;
	}
        var h = cur[3] * scale, w = scale;
        if (h < 0) {
          w = -h;
          h = scale;
        }
        ctx.fillRect(x, y, w, h);
      }
    }
  },
  turtle_dx: 0, // shift frame
  turtle_dy: 0,
  turtle_z: 1,  // zoom factor
  turtle_maillage: 1,
  turtle_draw: function (id, s) {
    if (s.length < 7) return;
    s = s.substr(5, s.length - 6);
    if (s.length > 7 && s.substr(s, 6) == "pixon(") {
      UI.pixon_draw(id, s.substr(6, s.length - 7));
      return;
    }
    if (s.length < 6 || s.substr(s, 5) != "logo(")
      return;
    s = s.substr(5, s.length - 6);
    //console.log(s);
    var v = eval(s);
    if (!Array.isArray(v)) return;
    //console.log(v[0]);
    var canvas = document.getElementById(id);
    var w = canvas.width, h = canvas.height;
    if (canvas.getContext) {
      var ctx = canvas.getContext('2d');
      var turtlezoom = UI.turtle_z, turtlex = UI.turtle_dx, turtley = UI.turtle_dy;
      // maillage
      if (UI.turtle_maillage & 3) {
        ctx.fillStyle = 'black';
        var xdecal = Math.floor(turtlex / 10.0) * 10;
        var ydecal = Math.floor(turtley / 10.0) * 10;
        if ((UI.turtle_maillage & 0x3) == 1) {
          for (var i = xdecal; i < w + xdecal; i += 10) {
            for (var j = ydecal; j < h + ydecal; j += 10) {
              var X = Math.floor((i - turtlex) * turtlezoom + .5);
              var Y = Math.floor((j - turtley) * turtlezoom + .5);
              // console.log(X,Y);
              ctx.fillRect(X, h - Y, 1, 1);
            }
          }
        } else {
          var dj = Math.sqrt(3.0) * 10, i0 = xdecal;
          for (var j = ydecal; j < h + ydecal; j += dj) {
            var J = Math.floor(h - (j - turtley) * turtlezoom);
            for (var i = i0; i < w + xdecal; i += 10) {
              ctx.fillRect(Math.floor((i - turtlex) * turtlezoom + .5), J, 1, 1);
            }
            i0 += dj;
            while (i0 >= 10)
              i0 -= 10;
          }
        }
      }
      var l = v.length, i;
      // montre la position et le cap (v[l-1])
      var prec = v[l - 1];
      ctx.font = '16px serif';
      ctx.fillStyle = 'yellow';
      ctx.fillRect(w - 40, 0, 40, 50);
      ctx.fillStyle = 'black';
      ctx.fillText('x:' + prec[0], w - 40, 15);
      ctx.fillText('y:' + prec[1], w - 40, 31);
      ctx.fillText('t:' + prec[2], w - 40, 49);
      // v[i]=[x(0),y(1),cap(2),status(3),r(4),chaine(5)],
      // couleur=status >> 11
      // longueur_tortue= (status>>3)&0xff
      // direct=status&4 (vrai si angle dans le sens trigo)
      // visible=status&2
      // crayon baisse=status&1
      // si r>0 arc/disque rayon=r & 0x1ff, theta1=(r >> 9) & 0x1ff, theta2=(r >> 18) & 0x1ff
      //        rempli=(r>>27)&0x1
      // si r<0 ligne polygonale extremite v[i] origine v[i+r] (r<0)
      for (k = 1; k < l; k++) {
        prec = v[k - 1];
        var cur = v[k];
        var preccouleur = prec[3] >> 11; // -> FIXME colors
        var curcouleur = prec[3] >> 11; // -> FIXME colors
        if (cur[5].length) {
          ctx.font = cur[4] + 'px serif';
          ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(curcouleur);
          ctx.fillText(cur[5], turtlezoom * (cur[0] - turtlex), h - turtlezoom * (cur[1] - turtley));
          continue;
        }
        var radius = cur[4], precradius = prec[4];
        var x1 = Math.floor(turtlezoom * (prec[0] - turtlex) + .5),
            y1 = Math.floor(turtlezoom * (prec[1] - turtley) + .5),
            x2 = Math.floor(turtlezoom * (cur[0] - turtlex) + .5),
            y2 = Math.floor(turtlezoom * (cur[1] - turtley) + .5);
        if (radius > 0) {
          var r = radius & 0x1ff, theta1, theta2, rempli, x, y, R, angle;
          theta1 = prec[2]+ ((radius >> 9) & 0x1ff);
          theta2 = prec[2] + ((radius >> 18) & 0x1ff);
          rempli = (radius >> 27) & 1;
	  var seg = (radius >> 28) & 1;
          R = Math.floor(turtlezoom * r + .5);
          angle1 = Math.PI / 180 * (theta1 - 90);
          angle2 = Math.PI / 180 * (theta2 - 90);
          x = Math.floor(turtlezoom * (cur[0] - turtlex - r * Math.cos(angle2)) + .5);
          y = Math.floor(turtlezoom * (cur[1] - turtley - r * Math.sin(angle2)) + .5);
          ctx.beginPath();
	  if (seg)
            ctx.moveTo(x2, h - y2);
	  else {
            ctx.moveTo(x, h - y);
            ctx.lineTo(x2, h - y2);
	  }
	  //console.log(x,y,x1,y1,angle1,angle2);
          ctx.arc(x, h - y, R, -angle2,-angle1);
          ctx.closePath();
          ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(curcouleur);
          if (rempli)
            ctx.fill();
          else
            ctx.stroke();
          continue;
        }
        if (prec[3] & 1) {
          ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(preccouleur);
          ctx.beginPath();
          ctx.moveTo(x1, h - y1);
          ctx.lineTo(x2, h - y2);
          ctx.closePath();
          ctx.stroke();
        }
        if (radius < -1 && k + radius >= 0) {
          ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(curcouleur);
          ctx.beginPath();
          var x0 = Math.floor(turtlezoom * (cur[0] - turtlex) + .5), y0 = Math.floor(turtlezoom * (cur[1] - turtley) + .5);
          //console.log('begin',x0,y0);
          ctx.moveTo(x0, h - y0);
          for (var i = -1; i >= radius; i--) {
            prec = v[k + i];
            var x = Math.floor(turtlezoom * (prec[0] - turtlex) + .5);
            var y = Math.floor(turtlezoom * (prec[1] - turtley) + .5);
            //console.log(i,x,y);
            ctx.lineTo(x, h - y);
          }
          //console.log('end',x0,y0);
          //ctx.lineTo(x0,h-y0);
          ctx.closePath();
          ctx.fill(); // automatically close path
        }
      }
      var cur = v[l - 1];
      if (cur[3] & 2) {
        // dessin de la tortue
        var x = Math.floor(turtlezoom * (cur[0] - turtlex) + .5);
        var y = Math.floor(turtlezoom * (cur[1] - turtley) + .5);
        var cost = Math.cos(cur[2] * Math.PI / 180);
        var sint = Math.sin(cur[2] * Math.PI / 180);
        var turtle_length = (cur[3] >> 3) & 0xff;
        var Dx = Math.floor(turtlezoom * turtle_length * cost / 2 + .5);
        var Dy = Math.floor(turtlezoom * turtle_length * sint / 2 + .5);
        //console.log('tortue',cur,w,h,turtlezoom,x,y,Dx,Dy);
        ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(curcouleur);
        ctx.beginPath();
        ctx.moveTo(x + Dy, h - (y - Dx));
        ctx.lineTo(x - Dy, h - (y + Dx));
        ctx.closePath();
        ctx.stroke();
        if (!(cur[3] & 1))
          ctx.strokeStyle = ctx.fillStyle = UI.turtle_color(curcouleur + 1);
        ctx.beginPath();
        ctx.moveTo(x + Dy, h - (y - Dx));
        ctx.lineTo(x + 3 * Dx, h - (y + 3 * Dy));
        ctx.closePath();
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x - Dy, h - (y + Dx));
        ctx.lineTo(x + 3 * Dx, h - (y + 3 * Dy));
        ctx.closePath();
        ctx.stroke();
      }
    }
  },
  render_canvas:function(field){
   var n=field.id;
   if (n && n.length>4 && n.substr(0,4)=='gr2d'){
     var s=field.innerHTML;
     //console.log(s);
     UI.turtle_draw(n, s);
   }
   if (n && n.length>5 && n.substr(0,5)=='gl3d_'){
    Module.print(n);
    var n3d=n.substr(5,n.length-5);
    giac3d(n3d);
    return;
   }
   var f=field.firstChild;
   for (;f;f=f.nextSibling){
     UI.render_canvas(f);
   }
  },
  eval_form: function(field){
    UI.giaceval('assume('+field.name.value+'=round('+field.valname.value+',12))');
    var s=UI.caseval(field.prog.value);
    var is_svg=s.substr(1,4)=='<svg';
    if (is_svg) field.parentNode.lastChild.innerHTML=s.substr(1,s.length-2);
    else field.parentNode.lastChild.innerHTML=s;
   UI.render_canvas(field.parentNode.lastChild);
  },
  latexeval:function(text){
    var tmp=text;
    if (tmp.length>10 && tmp.substr(0,10)=='GIAC_ERROR') return '"'+tmp.substr(11,tmp.length-11)+'"';
    if (tmp.length>5 && tmp.substr(0,5)=='gl3d_') return tmp;
    if (tmp.length>5 && tmp.substr(1,4)=='<svg') return tmp.substr(1,tmp.length-2);
    if (tmp.length>5 && tmp.substr(0,4)=='<svg') return tmp;
    if (tmp.length>3 && tmp.substr(0,3)=='<b>') return tmp;
     if (UI.usemathjax){
       tmp=UI.giaceval('latex(quote('+tmp+'))');
       var dollar=String.fromCharCode(36);
       tmp=dollar+dollar+tmp.substr(1,tmp.length-2)+dollar+dollar;
       return tmp;
     }
     tmp=UI.giaceval('mathml(quote('+tmp+',1))');
     tmp=tmp.substr(1,tmp.length-2);
    return tmp;   
  },
  ckenter:function(event,field,mode){
    var key = event.keyCode;
    if (key != 13 || event.shiftKey) return true;
   if (mode==3){ UI.quick(field.nextSibling); event.preventDefault(); field.select(); return true; }
    var tmp=field.value;
   Module.print(tmp);
    tmp=UI.caseval(tmp);
    if (mode==1){
      tmp=UI.rmquote(tmp); 
   }
   if (mode==2){
     tmp=UI.latexeval(tmp);
   }
   field.nextSibling.nextSibling.innerHTML=tmp;
   UI.render_canvas(field.nextSibling.nextSibling);
   if (UI.usemathjax) MathJax.Hub.Queue(["Typeset",MathJax.Hub,field.nextSibling.nextSibling]);
   if (event.preventDefault) event.preventDefault();
    return false;
  },
   exec: function(field){
     if (field.nodeName=="BUTTON" && field.innerHTML!='Clone' && field.innerHTML!='Restart' && field.innerHTML!='Exec. all'){
        field.click();
        return;
     }
     if (field.nodeName=="FORM"){
        UI.eval_form(field);
        return;
     }
     var f=field.firstChild;
     while (f){
       UI.exec(f);
       f=f.nextSibling;
     }
   },
  execonload: function(field){
     if (!Module.ready){ window.setTimeout(UI.execonload, 100, field); }
     var f=field.nextSibling;
     if (f && f.innerHTML=="onload" && field.nodeName=="BUTTON"){
        field.click();
        return;
     }
     f=field.firstChild;
     while (f){
       UI.execonload(f);
       f=f.nextSibling;
     }
   },
  textarealtgt: function(field){
     if (field.nodeName=="TEXTAREA"){
        var tmp=UI.ltgt(field.value);
        field.value=tmp[0];
        //field.style.height=20*(tmp[1]+1)+'px';
        field.rows=tmp[1]+1;
        return;
     }
     var f=field.firstChild;
     while (f){
       UI.textarealtgt(f);
       f=f.nextSibling;
     }
   }
 };
 window.onload = function(e){
   var isFirefox = typeof InstallTrigger !== 'undefined';   // Firefox 1.0+
   var isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;
  var ua = window.navigator.userAgent;
  var old_ie = ua.indexOf('MSIE ');
  var new_ie = ua.indexOf('Trident/');
  if ((!isFirefox && !isSafari) || (old_ie > -1) || (new_ie > -1) || window.chrome){
     UI.usemathjax=true;
     alert("Your browser does not support MathML, using MathJax for 2d rendering. Consider switching to Firefox for better rendering and faster results");
  }
  if (UI.usemathjax){
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  }
  var elem= document.getElementById('controlindex');
  elem.innerHTML='<hr><a href="'+String.fromCharCode(35)+'sec1">Table</a>, <a href="'+String.fromCharCode(35)+'sec2">Index</a>,'+elem.innerHTML;
  if (elem.style.maxHeight=='500px')
    elem.style.maxHeight=(window.innerHeight-120)+'px';
  elem= document.getElementById('maindiv');
  elem.style.maxHeight=(window.innerHeight-150)+'px';
  // Module.print(elem.innerHTML);
  //elem.parentNode.insertBefore(elem,null);
  giac3d = Module.cwrap('_ZN4giac13giac_rendererEPKc','number', ['string']);
  UI.giaceval('set_language(1);');
  //UI.giaceval('factor(x^4-1)');
  //UI.giaceval('sin(x+y)+f(t)');
  UI.textarealtgt(document.documentElement);
  window.setTimeout(UI.execonload, 1000, document.documentElement); // UI.execonload(document.documentElement);
  document.getElementById('output').innerHTML='';
 // if (confirm('Exec commands?')) UI.exec(document.documentElement);
 };
</script>


</p><!--CUT END -->
<!--HTMLFOOT-->
<!--ENDHTML-->
<!--FOOTER-->
<hr style="height:2"><blockquote class="quote"><em>This document was translated from L<sup>A</sup>T<sub>E</sub>X by
</em><a href="http://hevea.inria.fr/index.html"><em>H</em><em><span style="font-size:small"><sup>E</sup></span></em><em>V</em><em><span style="font-size:small"><sup>E</sup></span></em><em>A</em></a><em>.</em></blockquote></body>
</html>
